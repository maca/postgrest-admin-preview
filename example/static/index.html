<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Main</title>
  <style>body { padding: 0; margin: 0; }</style>
  <link rel="stylesheet" href="/icono.min.css" />
  <link rel="stylesheet" href="/milligram.min.css" />
  <link rel="stylesheet" href="/app.css" type="text/css" media="screen" />
  <script src="/main.js"></script>
</head>

<body>
    <script type="text/javascript">
        console.log("token: ", sessionStorage.getItem("jwt"))
        const app = Elm.Main.init({
            flags: {
                jwt: sessionStorage.getItem("jwt"),
                "loginBannerText": "**Welcome to postgrest-admin demo!**\n\nA back-office/admin interface for PostgREST api's.\n\nLogin with user: 'bluebox@example.com' and password: 'password'.\n\nSource code at\n[https://github.com/maca/postgrest-admin](https://github.com/maca/postgrest-admin)\n"
            }
        })
  
        app.ports.loggedIn.subscribe(jwt => {
            console.log("got token: ", jwt)
            sessionStorage.setItem("jwt", jwt)
        });

        app.ports.loggedOut.subscribe(_ => {
            sessionStorage.removeItem("jwt")
        });

        // elm-watch: reload page when HTML or other non-CSS files change
        window.addEventListener("elm-watch:changed-file-url-paths", (event) => {
            // Let elm-watch handle CSS hot reloading, only force reload for non-CSS files
            const changedFiles = event.detail.changedFileUrlPaths;
            const hasNonCssChanges = changedFiles.some(path => !path.endsWith('.css'));
            if (hasNonCssChanges) {
                window.location.reload();
            }
        });
    </script>
<body>
